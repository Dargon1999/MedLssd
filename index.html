<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçá SASPA NIGHT CITY </title>
	<link rel="icon" type="image/png" href="/favicon.png">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Rajdhani:wght@500;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

<div class="cyber-container">

    <!-- –ì–û–°–¢–¨ -->
    <div id="guest-view" class="cyber-panel">
        <h1 class="main-title">SASPA SYSTEM</h1>
        <h2 class="subtitle">MEDICAL DATABASE</h2>

        <p class="info-text">
            –ì–æ—Å—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø –∞–∫—Ç–∏–≤–µ–Ω
            <br><br>
            <button class="cyber-btn primary big" onclick="showAuth()">–í–•–û–î / –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</button>
        </p>

        <input class="cyber-input" id="med-search-guest" placeholder="–ü–û–ò–°–ö –ü–û –ò–ú–ï–ù–ò –ò–õ–ò –ü–ê–°–ü–û–†–¢–£" onkeyup="searchMedCardsGuest()">

        <div id="loading-guest" class="loading" style="display:none;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>

        <table class="cyber-table" id="med-table-guest">
            <thead>
                <tr>
                    <th>‚Ññ</th>
                    <th>–ò–ú–Ø</th>
                    <th>–ü–ê–°–ü–û–†–¢</th>
                    <th>–°–†–û–ö</th>
                    <th>–°–¢–ê–¢–£–°</th>
                    <th>–§–û–¢–û</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <!-- –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø -->
    <div id="auth" class="cyber-panel" style="display:none;">
        <h1 class="main-title">ACCESS TERMINAL</h1>

        <div id="login-form">
            <h3 class="form-title">–í–•–û–î</h3>
            <input id="login-email" class="cyber-input" placeholder="EMAIL" type="email">
            <input id="login-password" type="password" class="cyber-input" placeholder="–ü–ê–†–û–õ–¨">
            <button class="cyber-btn primary" onclick="login()">–í–û–ô–¢–ò</button>
            <p id="login-error" class="error-text"></p>
        </div>

        <div id="register-form" style="display:none;">
            <h3 class="form-title">–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</h3>
            <input id="reg-name" class="cyber-input" placeholder="–ò–ú–Ø">
            <input id="reg-email" class="cyber-input" placeholder="EMAIL" type="email">
            <input id="reg-password" type="password" class="cyber-input" placeholder="–ü–ê–†–û–õ–¨ (–º–∏–Ω. 6 —Å–∏–º–≤–æ–ª–æ–≤)">
            <input id="reg-code" class="cyber-input" placeholder="–ö–û–î –†–û–õ–ò">
            <button class="cyber-btn primary" onclick="register()">–°–û–ó–î–ê–¢–¨</button>
            <p id="reg-error" class="error-text"></p>
        </div>

        <div class="auth-switch">
            <button class="cyber-btn small" onclick="showLogin()">–í–•–û–î</button>
            <button class="cyber-btn small" onclick="showRegister()">–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</button>
            <button class="cyber-btn small" onclick="showGuestView()">‚Üê –ù–ê–ó–ê–î</button>
        </div>
    </div>

    <!-- DASHBOARD -->
    <div id="dashboard" class="cyber-panel" style="display:none;">
        <h1 class="main-title">SASPA CORE</h1>
        <p class="info-text">
            –û–ü–ï–†–ê–¢–û–†: <span id="user-name"></span> | –†–û–õ–¨: <span id="user-role"></span>
            <button class="cyber-btn small danger" onclick="logout()">–í–´–•–û–î</button>
        </p>

        <!-- –í–∫–ª–∞–¥–∫–∏ -->
        <div class="tab-switch">
            <button class="cyber-btn small" onclick="showTab('medcards-tab')">–ú–ï–î–ö–ê–†–¢–´</button>
            <button id="history-btn" class="cyber-btn small" onclick="showTab('history-tab')">–ò–°–¢–û–†–ò–Ø</button>
            <button id="users-btn" class="cyber-btn small" onclick="showTab('users-tab')">–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ò</button>
            <button class="cyber-btn small" onclick="showTab('mp-tab')">–ú–ü</button>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ú–µ–¥–∫–∞—Ä—Ç—ã -->
        <div id="medcards-tab" class="tab-content">
            <h3 class="form-title">–°–ü–ò–°–û–ö –ú–ï–î–ö–ê–†–¢</h3>
            <div class="controls">
                <input class="cyber-input search-input" id="med-search-admin" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏, –ø–∞—Å–ø–æ—Ä—Ç—É –∏ —Ç.–¥.">
                <button class="cyber-btn small search-btn" onclick="searchMedCardsAdmin()">–ù–∞–π—Ç–∏</button>
                <button class="cyber-btn small add-btn" onclick="toggleAddForm()">+ –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å</button>
                <button class="cyber-btn small sort-btn" id="sort-btn" onclick="toggleSortMedCards()">–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Å—Ä–æ–∫—É ‚Üì (–æ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –∫ –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω–æ–º—É)</button>
                <button class="cyber-btn small excel-btn" onclick="exportMedCardsToExcel()">‚Üì –°–∫–∞—á–∞—Ç—å –≤ Excel</button>
            </div>

            <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (—Å–∫—Ä—ã—Ç–∞—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
            <div id="add-med-form" class="form-grid" style="display:none;">
                <input id="add-name" class="cyber-input" placeholder="–ò–ú–Ø">
                <input id="add-passport" class="cyber-input" placeholder="–ü–ê–°–ü–û–†–¢ (—Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã)">
                <input id="add-expiry" class="cyber-input" type="date" placeholder="–î–ê–¢–ê (–≥–≥–≥–≥-–º–º-–¥–¥)" min="2000-01-01" max="2099-12-31">
                <input id="add-photo" class="cyber-input" placeholder="URL –§–û–¢–û –∏–ª–∏ '-' (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)">
                <button class="cyber-btn primary" onclick="addMedCard()">–î–û–ë–ê–í–ò–¢–¨</button>
            </div>
            <p id="add-med-error" class="error-text"></p>

            <table class="cyber-table" id="med-table-admin">
                <thead>
                    <tr>
                        <th>‚Ññ</th>
                        <th>–ò–ú–Ø</th>
                        <th>–ü–ê–°–ü–û–†–¢</th>
                        <th>–°–†–û–ö</th>
                        <th>–°–¢–ê–¢–£–°</th>
                        <th>–§–û–¢–û</th>
                        <th>–î–ï–ô–°–¢–í–ò–Ø</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ–¥–∫–∞—Ä—Ç—ã (–º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ) -->
        <div id="edit-med-modal" class="modal" style="display:none;">
            <div class="modal-content">
                <h3 class="form-title">–†–ï–î–ê–ö–¢–ò–†–û–í–ê–¢–¨ –ú–ï–î–ö–ê–†–¢–£</h3>
                <input id="edit-id" type="hidden">
                <input id="edit-name" class="cyber-input" placeholder="–ò–ú–Ø">
                <input id="edit-passport" class="cyber-input" placeholder="–ü–ê–°–ü–û–†–¢ (—Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã)">
                <input id="edit-expiry" class="cyber-input" type="date" min="2000-01-01" max="2099-12-31">
                <input id="edit-photo" class="cyber-input" placeholder="URL –§–û–¢–û –∏–ª–∏ '-'">
                <button class="cyber-btn primary" onclick="saveEditMedCard()">–°–û–•–†–ê–ù–ò–¢–¨</button>
                <button class="cyber-btn danger" onclick="closeEditModal()">–ó–ê–ö–†–´–¢–¨</button>
                <p id="edit-med-error" class="error-text"></p>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ò—Å—Ç–æ—Ä–∏—è -->
        <div id="history-tab" class="tab-content" style="display:none;">
            <h3 class="form-title">–ò–°–¢–û–†–ò–Ø –î–ï–ô–°–¢–í–ò–ô</h3>
            <div id="history-loading" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <table class="cyber-table" id="history-table" style="display:none;">
                <thead>
                    <tr>
                        <th>–î–ê–¢–ê</th>
                        <th>–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨</th>
                        <th>–î–ï–ô–°–¢–í–ò–ï</th>
                        <th>–î–ï–¢–ê–õ–ò</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <p id="history-empty" class="info-text" style="display:none;">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –≤ –∏—Å—Ç–æ—Ä–∏–∏</p>
            <p id="history-no-access" class="error-text" style="display:none;">–î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞</p>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ -->
        <div id="users-tab" class="tab-content" style="display:none;">
            <h3 class="form-title">–î–û–ë–ê–í–ò–¢–¨ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø (–¢–û–õ–¨–ö–û –ê–î–ú–ò–ù)</h3>
            <div class="form-grid">
                <input id="new-user-name" class="cyber-input" placeholder="–ò–ú–Ø">
                <input id="new-user-email" class="cyber-input" placeholder="EMAIL" type="email">
                <input id="new-user-password" type="password" class="cyber-input" placeholder="–ü–ê–†–û–õ–¨ (–º–∏–Ω. 6 —Å–∏–º–≤–æ–ª–æ–≤)">
                <select id="new-user-role" class="cyber-input">
                    <option value="checker">Checker</option>
                    <option value="admin">Admin</option>
                </select>
                <button class="cyber-btn primary" onclick="addNewUser()">–î–û–ë–ê–í–ò–¢–¨</button>
            </div>
            <p id="add-user-error" class="error-text"></p>

            <h3 class="form-title">–°–ü–ò–°–û–ö –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô</h3>
            <div id="users-loading" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <table class="cyber-table" id="users-table" style="display:none;">
                <thead>
                    <tr>
                        <th>–ò–ú–Ø</th>
                        <th>EMAIL</th>
                        <th>–†–û–õ–¨</th>
                        <th>–î–ï–ô–°–¢–í–ò–Ø</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <p id="users-empty" class="info-text" style="display:none;">–ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
            <p id="users-no-access" class="error-text" style="display:none;">–î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞</p>
        </div>

        <!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ) -->
        <div id="edit-user-modal" class="modal" style="display:none;">
            <div class="modal-content">
                <h3 class="form-title">–†–ï–î–ê–ö–¢–ò–†–û–í–ê–¢–¨ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø</h3>
                <input id="edit-user-uid" type="hidden">
                <input id="edit-user-name" class="cyber-input" placeholder="–ò–ú–Ø">
                <input id="edit-user-email" class="cyber-input" placeholder="EMAIL" type="email">
                <input id="edit-user-password" type="password" class="cyber-input" placeholder="–ù–û–í–´–ô –ü–ê–†–û–õ–¨ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)">
                <select id="edit-user-role" class="cyber-input">
                    <option value="checker">Checker</option>
                    <option value="admin">Admin</option>
                </select>
                <button class="cyber-btn primary" onclick="saveEditUser()">–°–û–•–†–ê–ù–ò–¢–¨</button>
                <button class="cyber-btn danger" onclick="closeEditUserModal()">–ó–ê–ö–†–´–¢–¨</button>
                <p id="edit-user-error" class="error-text"></p>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ú–ü -->
        <div id="mp-tab" class="tab-content" style="display:none;">
            <div class="card">
                <h1>–ú–ü ‚Üí Discord</h1>
                <div class="status">–°—Ç–∞—Ç—É—Å: <span id="status" class="offline">–û—Ñ—Ñ–ª–∞–π–Ω</span></div>
                <div>
                    <button class="btn" onclick="checkNow()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ–π—á–∞—Å</button>
                    <button class="btn" onclick="resetDB()" style="background:#ff5555">–°–±—Ä–æ—Å–∏—Ç—å –±–∞–∑—É</button>
                </div>
                <div class="log" id="log">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...</div>
            </div>
        </div>

    </div>

</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="script.js" defer></script>
</body>
</html>